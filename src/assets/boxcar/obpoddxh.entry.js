const t=window.boxcar.h;class e{constructor(){this.index=0,this.eachFade=400,this._animatedElements=[],this._elementNames=[],this._currentIndex=this.index,this._inTransition=!1,this._rapidChangeDirty=!1,this._init=!0}setIndex(t,e=null){this._init?this._currentIndex=t:t===e||this._inTransition?this._rapidChangeDirty=!0:this._transitionTo(t)}setViewById(t,e=null){if(t&&""!==t){for(let e=0;e<this._elementNames.length;e++)if(this._elementNames[e]===t)return void(this.index=e);return this.index=0,e}this.index=0}_transitionTo(t){this._inTransition=!0,(isNaN(t)||t>this._animatedElements.length)&&(t=0),M.anime({targets:this._animatedElements[this._currentIndex],opacity:[1,0],easing:"linear",duration:this.eachFade,complete:()=>{for(let t=0;t<this._animatedElements[this._currentIndex].length;t++)this._animatedElements[this._currentIndex][t].style.display="none";for(let e=0;e<this._animatedElements[t].length;e++)this._animatedElements[t][e].style.display="";M.anime({targets:this._animatedElements[t],opacity:[0,1],easing:"linear",duration:this.eachFade,complete:()=>{this._rapidChangeDirty&&(this._rapidChangeDirty=!1,this._transitionTo(this.index))}}),this._currentIndex=t,this._inTransition=!1,window.scrollTo({top:0,left:0,behavior:"instant"})}})}render(){return t("slot",null)}trackAnimatableElements(){this._animatedElements=[],this._elementNames=[];let t=this.dashboardElement.children;if(t.length>0)for(let e=0;e<t.length;e++)if(this._elementNames.push(t[e].getAttribute("id")),"hydrated"!=t[e].className)this._animatedElements.push([t[e]]);else{let i=[];if(t[e].children.length>0){let n=t[e].children;for(let t=0;t<n.length;t++)"hydrated"!=n[t].className&&i.push(n[t])}this._animatedElements.push(i)}}componentWillLoad(){this.dashboardElement.style.visibility="hidden"}componentDidLoad(){this.trackAnimatableElements(),this._currentIndex=this.index,this.view&&this.setViewById(this.view);for(let t=0;t<this._animatedElements.length;t++)if(t!==this.index)for(let e=0;e<this._animatedElements[t].length;e++)this._animatedElements[t][e].style.display="none",this._animatedElements[t][e].style.opacity="0.0";this._init=!1,setTimeout(()=>this.dashboardElement.style.visibility="visible",400)}static get is(){return"view-stack"}static get properties(){return{dashboardElement:{elementRef:!0},eachFade:{type:Number,attr:"each-fade"},index:{type:Number,attr:"index",reflectToAttr:!0,mutable:!0,watchCallbacks:["setIndex"]},view:{type:String,attr:"view",watchCallbacks:["setViewById"]}}}static get style(){return""}}export{e as ViewStack};